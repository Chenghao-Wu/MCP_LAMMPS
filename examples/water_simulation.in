# LAMMPS input script for water simulation with 10 TIP3P water molecules
# NVT ensemble at 300K

# Initialize simulation
units           real
boundary        p p p
atom_style      full
bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none
pair_style      lj/cut/coul/long 10.0
pair_modify     mix arithmetic
kspace_style    pppm 1.0e-4

# Read data file
read_data       water_10.data

# Set up groups
group           water type 1 2 3
group           O type 1
group           H type 2 3

# Set up pair coefficients for TIP3P water
pair_coeff      1 1 0.1521 3.188
pair_coeff      2 2 0.0000 0.000
pair_coeff      3 3 0.0000 0.000
pair_coeff      1 2 0.0000 0.000
pair_coeff      1 3 0.0000 0.000
pair_coeff      2 3 0.0000 0.000

# Set up bond coefficients for TIP3P water
bond_coeff      1 450.0 0.9572
angle_coeff     1 55.0 104.52

# Set up charges for TIP3P water
set             type 1 charge -0.830
set             type 2 charge 0.415
set             type 3 charge 0.415

# Set up neighbor list
neighbor        2.0 bin
neigh_modify    every 1 delay 0 check yes

# Set up output
thermo          100
thermo_style    custom step temp pe ke etotal press vol density
dump            myDump all custom 500 water_10.lammpstrj id type x y z vx vy vz
dump_modify     myDump sort id

# Minimization
minimize        1.0e-4 1.0e-6 1000 10000
undump          myDump
reset_timestep  0

# Equilibration at 300K (NVT)
timestep        1.0
fix             nvt all nvt temp 300.0 300.0 100.0
run             1000
unfix           nvt

# Production run at 300K (NVT)
fix             nvt_prod all nvt temp 300.0 300.0 100.0
run             5000
unfix           nvt_prod

# Final output
print           "Simulation completed successfully" 